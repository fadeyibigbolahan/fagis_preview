import{c as O,r as n,j as e,C as S,M as k,B as I,q as _,U as B,i as H,k as J}from"./index-CS7ZgHMT.js";import{C as X}from"./circle-alert-BRc3jNk4.js";import{A as y}from"./activity-BwlaxWnL.js";import{F as Y}from"./filter-BBmD6SGh.js";import{S as w}from"./search-CokmW1tD.js";import{C as G}from"./chevron-left-CuhOKgDU.js";import{C as K}from"./chevron-right-DWZf5eQ0.js";import{U as C}from"./user-plus-CAERzhWc.js";import{S as h}from"./square-pen-DkRzR1nR.js";import{R as Q}from"./refresh-cw-CX5PqqV6.js";import{X as V}from"./x-Dwv1eVjA.js";import{A as U}from"./award-CyvUNDzK.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=O("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),P={member_added:{icon:C,color:"text-green-600",bgColor:"bg-green-50",label:"Member Added",category:"members"},member_updated:{icon:h,color:"text-blue-600",bgColor:"bg-blue-50",label:"Member Updated",category:"members"},member_removed:{icon:A,color:"text-red-600",bgColor:"bg-red-50",label:"Member Removed",category:"members"},role_changed:{icon:Q,color:"text-purple-600",bgColor:"bg-purple-50",label:"Role Changed",category:"admin"},event_created:{icon:S,color:"text-indigo-600",bgColor:"bg-indigo-50",label:"Event Created",category:"events"},event_updated:{icon:h,color:"text-indigo-600",bgColor:"bg-indigo-50",label:"Event Updated",category:"events"},event_cancelled:{icon:V,color:"text-red-600",bgColor:"bg-red-50",label:"Event Cancelled",category:"events"},email_sent:{icon:k,color:"text-cyan-600",bgColor:"bg-cyan-50",label:"Email Sent",category:"communications"},template_updated:{icon:h,color:"text-orange-600",bgColor:"bg-orange-50",label:"Template Updated",category:"system"},certificate_issued:{icon:U,color:"text-yellow-600",bgColor:"bg-yellow-50",label:"Certificate Issued",category:"certificates"},org_created:{icon:I,color:"text-gray-600",bgColor:"bg-gray-50",label:"Organization Created",category:"system"},org_updated:{icon:_,color:"text-gray-600",bgColor:"bg-gray-50",label:"Organization Updated",category:"system"},admin_added:{icon:C,color:"text-emerald-600",bgColor:"bg-emerald-50",label:"Admin Added",category:"admin"},admin_removed:{icon:A,color:"text-red-600",bgColor:"bg-red-50",label:"Admin Removed",category:"admin"}},W=[{key:"all",label:"All Activities",icon:y},{key:"members",label:"Members",icon:B},{key:"events",label:"Events",icon:S},{key:"communications",label:"Communications",icon:k},{key:"certificates",label:"Certificates",icon:U},{key:"admin",label:"Administration",icon:_},{key:"system",label:"System",icon:I}],me=()=>{const[d,E]=n.useState([]),[f,p]=n.useState([]),[m,M]=n.useState("all"),[x,L]=n.useState(""),[o,F]=n.useState(1),[$,j]=n.useState(!0),[v,N]=n.useState(null),[r,R]=n.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:8}),u=8;n.useEffect(()=>{(async()=>{var s,a;try{j(!0),N(null);const l=localStorage.getItem("authToken"),g=localStorage.getItem("authUser"),c=g?JSON.parse(g):null;if(console.log("Stored user:",c),!c._id)throw new Error("User ID not found");const i=await H.get(`${J}org/activity-logs/user/${c._id}?page=${o}&limit=${u}`,{headers:{Authorization:l}});if(console.log("API response:",i.data),i.data.success)E(i.data.data),p(i.data.data),R(i.data.pagination||{currentPage:o,totalPages:Math.ceil(i.data.data.length/u),totalItems:i.data.data.length,itemsPerPage:u});else throw new Error(i.data.message||"Failed to fetch activities")}catch(l){console.error("Error fetching activities:",l),N(((a=(s=l.response)==null?void 0:s.data)==null?void 0:a.message)||l.message||"Failed to load activities")}finally{j(!1)}})()},[o]),n.useEffect(()=>{let t=d;if(m!=="all"&&(t=t.filter(s=>{const a=P[s.action];return a&&a.category===m})),x){const s=x.toLowerCase();t=t.filter(a=>a.details.toLowerCase().includes(s)||a.userId&&a.userId.fullName&&a.userId.fullName.toLowerCase().includes(s))}p(t)},[m,x,d]);const T=t=>{const s=new Date(t),l=(new Date-s)/(1e3*60*60);return l<1?"Just now":l<24?`${Math.floor(l)} hours ago`:l<48?"Yesterday":s.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})},D=t=>{M(t)},z=t=>{L(t.target.value)},b=t=>{t>0&&t<=r.totalPages&&F(t)},q=({activity:t})=>{var c;const s=P[t.action],a=(s==null?void 0:s.icon)||y,l=((c=t.userId)==null?void 0:c.fullName)||"System",g=l.split(" ").map(i=>i[0]).join("").toUpperCase();return e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:e.jsx(a,{className:`w-5 h-5 ${(s==null?void 0:s.color)||"text-gray-600"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:(s==null?void 0:s.label)||"Unknown Action"}),e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:T(t.createdAt||t.date)})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:t.details}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center text-blue-800 text-xs font-semibold mr-2",children:g}),e.jsxs("span",{className:"text-xs text-gray-500",children:["by ",l]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${(s==null?void 0:s.bgColor)||"bg-gray-100"} ${(s==null?void 0:s.color)||"text-gray-600"}`,children:(s==null?void 0:s.category)||"general"})]})]})]})})};return $&&d.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading activity feed..."})]})}):v&&d.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(X,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Activities"}),e.jsx("p",{className:"text-gray-600 mb-4",children:v}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]})}):e.jsx("div",{className:"min-h-screen bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6 md:mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2 gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(y,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-gray-900",children:"Activity Feed"})]}),e.jsxs("div",{className:"text-xs sm:text-sm text-gray-500",children:["Last updated: ",new Date().toLocaleTimeString()]})]}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 max-w-2xl",children:"Monitor all organizational activities, member interactions, and system events in real-time."})]}),e.jsx("div",{className:"bg-white text-xs rounded-lg border border-gray-200 p-4 sm:p-6 mb-6 sm:mb-8",children:e.jsxs("div",{className:"space-y-4 lg:space-y-0 lg:flex lg:items-center lg:justify-between lg:gap-6",children:[e.jsxs("div",{className:"lg:flex-1",children:[e.jsxs("div",{className:"flex items-center mb-3 lg:mb-4",children:[e.jsx(Y,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter by Category"})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2",children:W.map(t=>{const s=t.icon;return e.jsxs("button",{onClick:()=>D(t.key),className:`flex items-center px-2.5 sm:px-3 lg:px-4 py-1.5 sm:py-2 rounded-md lg:rounded-lg text-xs sm:text-sm font-medium transition-all duration-200 whitespace-nowrap ${m===t.key?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(s,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:t.label}),e.jsx("span",{className:"sm:hidden",children:t.label==="All Activities"?"All":t.label==="Communications"?"Comm":t.label==="Administration"?"Admin":t.label})]},t.key)})})]}),e.jsx("div",{className:"w-full sm:w-auto lg:w-80 xl:w-96",children:e.jsxs("div",{className:"relative",children:[e.jsx(w,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("input",{type:"text",placeholder:"Search activities...",value:x,onChange:z,className:"w-full pl-9 sm:pl-10 pr-4 py-2.5 sm:py-3 text-sm border border-gray-300 rounded-md lg:rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]})})]})}),e.jsx("div",{className:"space-y-4 mb-8",children:f.length>0?f.map(t=>e.jsx(q,{activity:t},t._id)):e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(w,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No activities found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search terms or filters to find what you're looking for."})]})})}),r.totalPages>1&&e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:(r.currentPage-1)*r.itemsPerPage+1})," ","to"," ",e.jsx("span",{className:"font-medium",children:Math.min(r.currentPage*r.itemsPerPage,r.totalItems)})," ","of ",e.jsx("span",{className:"font-medium",children:r.totalItems})," ","results"]}),e.jsxs("nav",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>b(o-1),disabled:o===1,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,r.totalPages)},(t,s)=>{let a;return r.totalPages<=5||o<=3?a=s+1:o>=r.totalPages-2?a=r.totalPages-4+s:a=o-2+s,e.jsx("button",{onClick:()=>b(a),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${o===a?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"}`,children:a},a)})}),e.jsxs("button",{onClick:()=>b(o+1),disabled:o===r.totalPages,className:"flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Next",e.jsx(K,{className:"w-4 h-4 ml-1"})]})]})]})})]})})};export{me as default};
