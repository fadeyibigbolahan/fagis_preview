import{c as fe,m as je,r as l,u as Ne,i as v,k as w,j as e,P as ve,U as we,M as Y,t as Ce}from"./index-AW9N4IJw.js";import{S as C,T as Se}from"./trash-2-BHw7KsVz.js";import{E as ke}from"./ellipsis-vertical-D0Isyhqd.js";import{E as Me}from"./eye-BGTFzyno.js";import{S as ze}from"./square-pen-Demsx26p.js";import{C as Ae}from"./calendar-plus-HWSGZOp2.js";import{X as Ee}from"./x-DFoMAH7n.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=fe("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]),S=({isOpen:p,onClose:G,title:h,children:a})=>p?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:h}),e.jsx("button",{onClick:G,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ee,{size:24})})]}),e.jsx("div",{className:"p-6",children:a})]})}):null,Pe=()=>{const{orgId:p}=je(),[G,h]=l.useState([]),[a,j]=l.useState(null),[J,k]=l.useState(!1),[K,M]=l.useState(!1),[Q,P]=l.useState(!1),[W,V]=l.useState(!1),[g,c]=l.useState(!1),[z,Z]=l.useState(""),[T,d]=l.useState(null),[R,ee]=l.useState(null),[U,se]=l.useState({top:0,left:0}),[te,A]=l.useState(!1),[x,b]=l.useState({subject:"",message:"",recipients:[]}),ae=Ne(),re=s=>{if(T!==s&&R){const t=R.getBoundingClientRect();se({top:t.bottom+window.scrollY+4,left:t.right+window.scrollX-192})}d(T===s?null:s)},[L,le]=l.useState([]),[o,m]=l.useState({name:"",description:"",type:"department",members:[]}),[u,E]=l.useState(""),[_,q]=l.useState(""),y=L.filter(s=>s.fullName.toLowerCase().includes(u.toLowerCase())||s.email.toLowerCase().includes(u.toLowerCase())),F=(a==null?void 0:a.members.filter(s=>{var n,i;const t=((n=s.userId)==null?void 0:n.fullName)||s.fullName||"",r=((i=s.userId)==null?void 0:i.email)||s.email||"";return t.toLowerCase().includes(_.toLowerCase())||r.toLowerCase().includes(_.toLowerCase())}))||[];l.useEffect(()=>{ne(),oe()},[]);const ne=async()=>{c(!0);try{const s=localStorage.getItem("authToken"),{data:t}=await v.get(`${w}organizations/${p}/groups`,{headers:{Authorization:s}});console.log("available groups",t),h(t.groups)}catch(s){console.log("groups error:",s),alert("Error fetching groups: "+s.message)}finally{c(!1)}},oe=async()=>{try{const s=localStorage.getItem("authToken"),{data:t}=await v.get(`${w}organizations/${p}/members`,{headers:{Authorization:s}});console.log("available members",t),le(t.members)}catch(s){console.error(s),setError("Failed to fetch organization data")}},ie=async s=>{var t,r;c(!0);try{const n=localStorage.getItem("authToken"),N=(await v.post(`${w}organizations/${p}/groups`,{name:s.name,description:s.description,members:s.members,type:s.type||"department"},{headers:{Authorization:n}})).data.group;h(I=>[...I,N]),k(!1),f(),alert("Group created successfully!")}catch(n){console.error("Error creating group:",n),alert("Error creating group: "+(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||n.message))}finally{c(!1)}},ce=async(s,t)=>{var r,n;console.log("Updating group:",s,t),c(!0);try{const i=localStorage.getItem("authToken"),{data:N}=await v.put(`${w}organizations/${s}`,t,{headers:{Authorization:i}});console.log("Group updated:",N),h(I=>I.map(O=>O._id===s?{...O,...N.group,members:L.filter(ye=>N.group.members.includes(ye._id))}:O)),console.log("available members after update:",L),M(!1),f(),alert("Group updated successfully!")}catch(i){console.error(i),alert("Error updating group: "+(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.message)||i.message))}finally{c(!1)}},de=async s=>{if(window.confirm("Are you sure you want to delete this group?")){c(!0);try{h(t=>t.filter(r=>r._id!==s)),alert("Group deleted successfully!")}catch(t){alert("Error deleting group: "+t.message)}finally{c(!1)}}},f=()=>{m({organizationId:"",name:"",description:"",type:"department",members:[]}),j(null),E("")},me=s=>{s.preventDefault(),ce(a._id,o)},xe=s=>{s.preventDefault(),ie(o)},ue=s=>{j(s),m({organizationId:s.organizationId._id,name:s.name,description:s.description||"",type:s.type,members:s.members.map(t=>t._id)}),M(!0)},B=s=>{j(s),m({...o,members:s.members.map(t=>t._id)}),P(!0)},pe=s=>{console.log("Viewing group:",s),j(s),V(!0)},D=s=>{m(t=>({...t,members:t.members.includes(s)?t.members.filter(r=>r!==s):[...t.members,s]}))},H=G.filter(s=>s.name.toLowerCase().includes(z.toLowerCase())||s.organizationId.name.toLowerCase().includes(z.toLowerCase())||s.type.toLowerCase().includes(z.toLowerCase())),X=s=>{j(s),b({subject:"",message:"",recipients:s.members.map(t=>t._id)}),A(!0)},ge=async s=>{var t,r;c(!0);try{const n=localStorage.getItem("authToken"),i=await v.post(`${w}organizations/${p}/groups/${a._id}/send-message`,{subject:s.subject,message:s.message,recipients:s.recipients},{headers:{Authorization:n}});console.log("Message sent:",i.data),A(!1),$(),alert("Message sent successfully!")}catch(n){console.error("Error sending message:",n),alert("Error sending message: "+(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||n.message))}finally{c(!1)}},$=()=>{b({subject:"",message:"",recipients:[]}),q("")},he=s=>{s.preventDefault(),ge(x)},be=s=>{b(t=>({...t,recipients:t.recipients.includes(s)?t.recipients.filter(r=>r!==s):[...t.recipients,s]}))};return e.jsx("div",{className:"p-6 bg-white min-h-screen text-xs",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Group Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage organization groups, members, and permissions"})]}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search groups...",value:z,onChange:s=>Z(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),e.jsxs("button",{onClick:()=>k(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(ve,{size:20}),"Create Group"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Group Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organization"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Members"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"Loading groups..."})}):H.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:"No groups found"})}):H.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),s.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:s.description})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.organizationId.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.type==="department"?"bg-blue-100 text-blue-800":s.type==="committee"?"bg-green-100 text-green-800":s.type==="circle"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:s.type})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[s.members.length," members"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"relative",children:e.jsx("button",{ref:t=>ee(t),onClick:()=>re(s._id),className:"flex items-center justify-center w-8 h-8 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",title:"Actions",children:e.jsx(ke,{size:16})})})})}),T===s._id&&e.jsx("div",{className:"fixed inset-0 z-50",onClick:()=>d(null),children:e.jsx("div",{className:"absolute w-48 bg-white rounded-md shadow-lg border border-gray-200",style:{top:U.top,left:U.left},onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{pe(s),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(Me,{size:16,className:"mr-3 text-[#7A54A1]"}),"View Details"]}),e.jsxs("button",{onClick:()=>{ue(s),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(ze,{size:16,className:"mr-3 text-[#7A54A1]"}),"Edit Group"]}),e.jsxs("button",{onClick:()=>{B(s),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(we,{size:16,className:"mr-3 text-[#7A54A1]"}),"Manage Members"]}),e.jsxs("button",{onClick:()=>{ae(`/dashboard/membership/create-event/${p}/${s._id}`),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(Ae,{size:16,className:"mr-3 text-[#7A54A1]"}),"Create Event"]}),e.jsxs("button",{onClick:()=>{X(s),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(Y,{size:16,className:"mr-3 text-[#7A54A1]"}),"Send Message"]}),e.jsxs("button",{onClick:()=>{X(s),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(_e,{size:16,className:"mr-3 text-[#7A54A1]"}),"Permissions"]}),e.jsxs("button",{onClick:()=>{B(s),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(Ce,{size:16,className:"mr-3 text-[#7A54A1]"}),"Settings"]}),e.jsx("hr",{className:"my-1"}),e.jsxs("button",{onClick:()=>{de(s._id),d(null)},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(Se,{size:16,className:"mr-3"}),"Delete Group"]})]})})})]},s._id))})]})}),e.jsx(S,{isOpen:J,onClose:()=>{k(!1),f()},title:"Create New Group",children:e.jsxs("form",{onSubmit:xe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group Name *"}),e.jsx("input",{type:"text",value:o.name,onChange:s=>m(t=>({...t,name:s.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Enter group name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:o.description,onChange:s=>m(t=>({...t,description:s.target.value})),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Enter group description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group Type"}),e.jsxs("select",{value:o.type,onChange:s=>m(t=>({...t,type:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"department",children:"Department"}),e.jsx("option",{value:"committee",children:"Committee"}),e.jsx("option",{value:"circle",children:"Circle"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Members"}),e.jsxs("div",{className:"border border-gray-300 rounded-lg",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search members...",value:u,onChange:s=>E(s.target.value),className:"pl-9 pr-3 py-2 w-full border border-gray-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none text-sm"})]})}),e.jsx("div",{className:"max-h-40 overflow-y-auto p-3",children:y.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:u?"No members found":"No members available"}):y.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:o.members.includes(s._id),onChange:()=>D(s._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm",children:[s.fullName," (",s.email,")"]})]},s._id))})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:g,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:g?"Creating...":"Create Group"}),e.jsx("button",{type:"button",onClick:()=>{k(!1),f()},className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})}),e.jsx(S,{isOpen:K,onClose:()=>{M(!1),f()},title:"Edit Group",children:e.jsxs("form",{onSubmit:me,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group Name *"}),e.jsx("input",{type:"text",value:o.name,onChange:s=>m(t=>({...t,name:s.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Enter group name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:o.description,onChange:s=>m(t=>({...t,description:s.target.value})),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Enter group description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group Type"}),e.jsxs("select",{value:o.type,onChange:s=>m(t=>({...t,type:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"department",children:"Department"}),e.jsx("option",{value:"committee",children:"Committee"}),e.jsx("option",{value:"circle",children:"Circle"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Members"}),e.jsxs("div",{className:"border border-gray-300 rounded-lg",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search members...",value:u,onChange:s=>E(s.target.value),className:"pl-9 pr-3 py-2 w-full border border-gray-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none text-sm"})]})}),e.jsx("div",{className:"max-h-40 overflow-y-auto p-3",children:y.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:u?"No members found":"No members available"}):y.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:o.members.includes(s._id),onChange:()=>D(s._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm",children:[s.fullName," (",s.email,")"]})]},s._id))})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:g,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:g?"Updating...":"Update Group"}),e.jsx("button",{type:"button",onClick:()=>{M(!1),f()},className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})}),e.jsx(S,{isOpen:Q,onClose:()=>P(!1),title:`Manage Members - ${a==null?void 0:a.name}`,children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Select Members"}),e.jsxs("div",{className:"border border-gray-300 rounded-lg",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search members...",value:u,onChange:s=>E(s.target.value),className:"pl-9 pr-3 py-2 w-full border border-gray-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none text-sm"})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto p-3",children:y.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:u?"No members found":"No members available"}):y.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("input",{type:"checkbox",checked:o.members.includes(s._id),onChange:()=>D(s._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName}),e.jsx("div",{className:"text-xs text-gray-500",children:s.email})]})]},s._id))})]})]})}),e.jsx(S,{isOpen:W,onClose:()=>V(!1),title:"Group Details",children:a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Group Name"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:a.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Organization"}),e.jsx("p",{className:"text-lg text-gray-900",children:a.organizationId.name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-900",children:a.description||"No description provided"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Type"}),e.jsx("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${a.type==="department"?"bg-blue-100 text-blue-800":a.type==="committee"?"bg-green-100 text-green-800":a.type==="circle"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:a.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500 mb-1",children:"Created"}),e.jsx("p",{className:"text-gray-900",children:new Date(a.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:["Members (",a.members.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:a.members.length===0?e.jsx("p",{className:"text-gray-500 italic",children:"No members assigned"}):a.members.map(s=>{var t,r;return e.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-medium",children:(r=(t=s==null?void 0:s.userId)==null?void 0:t.fullName)==null?void 0:r.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.userId.fullName}),e.jsx("p",{className:"text-xs text-gray-500",children:s.userId.email})]})]},s._id)})})]})]})}),e.jsx(S,{isOpen:te,onClose:()=>{A(!1),$()},title:`Send Message - ${a==null?void 0:a.name}`,children:e.jsxs("form",{onSubmit:he,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),e.jsx("input",{type:"text",value:x.subject,onChange:s=>b(t=>({...t,subject:s.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Enter message subject"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),e.jsx("textarea",{value:x.message,onChange:s=>b(t=>({...t,message:s.target.value})),required:!0,rows:"6",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Enter your message"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Recipients (",x.recipients.length," selected)"]}),e.jsxs("div",{className:"border border-gray-300 rounded-lg",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search recipients...",value:_,onChange:s=>q(s.target.value),className:"pl-9 pr-3 py-2 w-full border border-gray-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none text-sm"})]})}),e.jsxs("div",{className:"max-h-40 overflow-y-auto p-3",children:[e.jsx("div",{className:"mb-2",children:e.jsx("button",{type:"button",onClick:()=>{const s=(a==null?void 0:a.members.map(t=>t._id))||[];b(t=>({...t,recipients:x.recipients.length===s.length?[]:s}))},className:"text-xs text-blue-600 hover:text-blue-800",children:x.recipients.length===(a==null?void 0:a.members.length)?"Deselect All":"Select All"})}),F.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:_?"No recipients found":"No recipients available"}):F.map(s=>{var t,r;return e.jsxs("label",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:x.recipients.includes(s._id),onChange:()=>be(s._id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((t=s.userId)==null?void 0:t.fullName)||s.fullName}),e.jsx("div",{className:"text-xs text-gray-500",children:((r=s.userId)==null?void 0:r.email)||s.email})]})]},s._id)})]})]})]}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["This message will be sent as an email to"," ",x.recipients.length," recipient(s)."]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsxs("button",{type:"submit",disabled:g||x.recipients.length===0,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Y,{size:16}),g?"Sending...":"Send Message"]}),e.jsx("button",{type:"button",onClick:()=>{A(!1),$()},className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})})]})})};export{Pe as default};
