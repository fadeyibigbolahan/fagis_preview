import{c as Z,r as i,u as Y,j as e,i as U,k as F,L as ie,C as ee,P as le,U as Q,t as V,M as oe}from"./index-DO2kdC5F.js";import{i as ce}from"./index.esm-CVZJPh_s.js";import{o as de}from"./paddleUtils-Dzwv-Tny.js";import{X as me}from"./x-BHlkFy7n.js";import{L as xe}from"./loader-circle-6ug0gChY.js";import{S as ue}from"./star-BNo_roqw.js";import{C as se}from"./check-C_5RVVC4.js";import{C as W}from"./chevron-down-B3w_-vFU.js";import{T as D,R as te}from"./triangle-alert-RvNR24k0.js";import{B as ge}from"./building-2-DchrpeMb.js";import{C as ae}from"./chevron-up-JdseQQog.js";import{T as re}from"./trending-up-BoeaxOVV.js";import{F as pe}from"./filter-BARdbpGT.js";import{G as he,B as fe}from"./globe-DUcfPuut.js";import{L as be}from"./link-CxYU2TyO.js";import{E as ye}from"./eye-AFhO17QU.js";import{D as je}from"./dollar-sign-DqsiPZ4N.js";import{C as _}from"./clock-ByByMpMK.js";import{C as we}from"./circle-check-big-BqTq3-8G.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=Z("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=Z("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),ke=({email:b,isPopular:a,amountInNaira:x,planId:C,moduleKey:v,duration:g,onSuccess:y})=>{const[p,z]=i.useState(!1),[j,d]=i.useState(""),u=Y(),I=async()=>{var P,k,$,A,E;try{z(!0),d("");const t=localStorage.getItem("authToken");t||(d("You need to be signed in to subscribe to a module."),setTimeout(()=>{u("/signin")},3e3)),console.log("Upgrade with:",{moduleKey:v,planId:C,duration:g});const l=(await U.post(`${F}subscriptions/upgrade/module`,{moduleKey:v,newPlanId:C,newDuration:g},{headers:{Authorization:t}})).data;l.success&&l.transactionId?await de(l.transactionId,{success:s=>{console.log("Payment successful:",s),y&&y({transactionId:l.transactionId,moduleKey:v,duration:g,amount:x})},error:s=>{console.error("Checkout error:",s),d("Payment failed. Please try again.")}}):d(l.error||"Failed to initiate subscription")}catch(t){if(console.error("Subscription error:",t),((P=t.response)==null?void 0:P.status)===401){localStorage.removeItem("authToken"),localStorage.removeItem("authUser"),d("You need to be signed in to subscribe to a module."),setTimeout(()=>{u("/signin",{state:{message:"Your session has expired. Please sign in again."}})},3e3);return}if(d((($=(k=t.response)==null?void 0:k.data)==null?void 0:$.error)||"Subscription failed. Please try again."),((E=(A=t==null?void 0:t.response)==null?void 0:A.data)==null?void 0:E.error)===`You already have an active subscription to the ${v} module`){setTimeout(()=>{u("/dashboard/overview/admin-organization")},3e3);return}}finally{z(!1)}};return e.jsxs("button",{onClick:I,disabled:p,className:`w-full py-3 px-6 rounded-lg font-semibold transition-all ${a?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700":"bg-gray-900 text-white hover:bg-gray-800"} ${p?"opacity-50 cursor-not-allowed":"hover:shadow-lg"}`,children:[p?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Processing..."]}):"Subscribe Now",j&&e.jsx("div",{className:"text-red-200 text-sm mt-1",children:j})]})},Se=({isOpen:b,onClose:a,currentPlan:x,onUpgradeSuccess:C})=>{const[v,g]=i.useState([]),[y,p]=i.useState(!0),[z,j]=i.useState(""),[d,u]=i.useState("1"),I="admin-organization";i.useEffect(()=>{b&&P()},[b]);const P=async()=>{try{p(!0);const t=localStorage.getItem("authToken"),n=await U.get(`${F}module-plans?moduleKey=${I}`,{headers:{Authorization:t}});g(n.data.data),j("")}catch(t){j("Failed to load plans"),console.error(t),g([{_id:"687b2e098c158008efc2ae5a",package:"free",moduleKey:"admin-organization",description:"Basic access to create 1 organization with default settings.",features:{maxOrganizations:1,allowCustomBranding:!1},pricing:{1:0,3:0,6:0,12:0}},{_id:"687b2e0a8c158008efc2ae5b",package:"basic",moduleKey:"admin-organization",description:"Allows up to 3 organizations and basic admin tools.",features:{maxOrganizations:3,allowCustomBranding:!0},pricing:{1:5,3:14.25,6:27,12:50}},{_id:"687b2e0a8c158008efc2ae5c",package:"pro",moduleKey:"admin-organization",description:"Advanced admin features for medium-sized teams.",features:{maxOrganizations:10,subAdminSupport:!0,documentUpload:!0},pricing:{1:15,3:42.75,6:81,12:150}},{_id:"687b2e0a8c158008efc2ae5d",package:"enterprise",moduleKey:"admin-organization",description:"Full control with unlimited orgs, audit logs, and API access.",features:{maxOrganizations:"unlimited",auditLogs:!0,advancedRoles:!0,apiAccess:!0},pricing:{1:30,3:85.5,6:162,12:300}}])}finally{p(!1)}},k=()=>e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:d,onChange:t=>u(t.target.value),className:"appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 pr-10 text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm cursor-pointer text-sm",children:[e.jsx("option",{value:"1",children:"1 Month"}),e.jsx("option",{value:"3",children:"3 Months"}),e.jsx("option",{value:"6",children:"6 Months"}),e.jsx("option",{value:"12",children:"12 Months"})]}),e.jsx(W,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]})}),$=t=>{const n=[],l=t.features||{};return l.maxOrganizations&&n.push(`${l.maxOrganizations==="unlimited"?"Unlimited":l.maxOrganizations} organizations`),l.allowCustomBranding&&n.push("Custom branding"),l.subAdminSupport&&n.push("Sub-admin support"),l.documentUpload&&n.push("Document upload"),l.auditLogs&&n.push("Audit logs"),l.advancedRoles&&n.push("Advanced roles & permissions"),l.apiAccess&&n.push("API access"),l.prioritySupport&&n.push("Priority support"),t.package==="free"?n.push("Basic admin dashboard","Email support","1 organization limit"):t.package==="basic"?n.push("Basic admin dashboard","Email support","Basic analytics","3 organizations"):t.package==="pro"?n.push("Advanced admin dashboard","Priority support","Advanced analytics","10 organizations","Custom workflows"):t.package==="enterprise"&&n.push("Full admin suite","24/7 dedicated support","Advanced analytics","Unlimited organizations","White-label support","Custom integrations"),n},A=t=>t.package==="pro",E=t=>{switch(t){case"free":return"🔰";case"basic":return"🚀";case"pro":return"⭐";case"enterprise":return"🏢";default:return"📊"}};return b?e.jsx("div",{className:"fixed text-xs inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Change Admin & Organization Plan"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage multiple organizations with advanced admin tools"})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(me,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:["Current plan:"," ",e.jsx("span",{className:"font-semibold capitalize",children:x})]})}),e.jsx(k,{}),y?e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(xe,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading admin plans..."})]}):z?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 max-w-md mx-auto",children:[e.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Error Loading Plans"}),e.jsx("p",{className:"text-red-500 text-sm",children:z})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-12",children:v.map(t=>{const n=A(t),l=$(t),s=t.pricing[d]||0,o=d==="1"?s:(s/parseInt(d)).toFixed(2);return t.package==="free"&&x!=="free"?null:e.jsxs("div",{className:`flex flex-col bg-white rounded-xl p-6 border-2 ${n?"border-blue-500 shadow-xl scale-105 bg-gradient-to-b from-white to-blue-50":t.package==="enterprise"?"border-purple-500 bg-gradient-to-b from-white to-purple-50":"border-gray-200"} transition-all duration-300 relative`,children:[n&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white px-3 py-1 rounded-full text-xs font-semibold shadow-lg",children:[e.jsx(ue,{className:"w-3 h-3 inline mr-1"}),"Most Popular"]})}),t.package==="enterprise"&&!n&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-600 text-white px-3 py-1 rounded-full text-xs font-semibold shadow-lg",children:"💎 Enterprise"})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center text-2xl ${n?"bg-gradient-to-br from-blue-500 to-purple-600":t.package==="enterprise"?"bg-gradient-to-br from-purple-500 to-pink-600":"bg-gray-100"}`,children:E(t.package)}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2 capitalize",children:t.package}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:t.description}),e.jsxs("div",{className:"flex items-baseline justify-center",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["$",o]}),e.jsx("span",{className:"text-gray-600 ml-2",children:"/mo"})]}),d!=="1"&&e.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["$",s," total for ",d," month",d!=="1"?"s":""]})]}),e.jsx("ul",{className:"space-y-3 mb-6 flex-1",children:l.map((w,O)=>e.jsxs("li",{className:"flex items-start text-sm",children:[e.jsx(se,{className:"w-4 h-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-700",children:w})]},O))}),t.package!=="free"&&e.jsx(ke,{email:localStorage.getItem("userEmail"),isPopular:n,amountInNaira:s,moduleKey:I,planId:t.package,duration:d,onSuccess:w=>{C(w),a()},buttonText:t.package===x?"Renew Plan":`Upgrade to ${t.package}`,buttonClass:`w-full ${n?"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700":t.package==="enterprise"?"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700":"bg-gray-600 hover:bg-gray-700"} text-white py-3 px-4 rounded-lg font-semibold transition-colors`}),t.package==="free"&&e.jsx("button",{className:"w-full bg-gray-300 text-gray-700 py-3 px-4 rounded-lg font-semibold cursor-not-allowed",disabled:!0,children:"Current Plan"})]},t._id)})})]})]})}):null},ze=({orgCount:b=0})=>{var J,q,X;const[a,x]=i.useState(null),[C,v]=i.useState(!0),[g,y]=i.useState(null),[p,z]=i.useState(b),[j,d]=i.useState(!1),[u,I]=i.useState(!1),[P,k]=i.useState(!1),[$,A]=i.useState(!1),[E,t]=i.useState(null);Y(),i.useEffect(()=>{ce({environment:"sandbox",token:"test_d26be2bbdec495f9c195fa2b6b6"}).then(r=>{console.log("Paddle initialized:",r),t(r)}).catch(r=>{console.error("Failed to initialize Paddle:",r)})},[]),i.useEffect(()=>{z(b)},[b]);const n=()=>{A(!0)},l=r=>{console.log("Upgrade successful:",r),alert(`Successfully upgraded to ${r.planId} plan!`)},s=async()=>{var r,m,N,S;if(a!=null&&a.moduleKey){I(!0),y(null);try{const f=localStorage.getItem("authToken"),M=await U.post(`${F}subscriptions/renew/module`,{moduleKey:a.moduleKey},{headers:{Authorization:f}});console.log("Renewal response:",M.data),M.data.transactionId&&E?E.Checkout.open({transactionId:M.data.transactionId,successCallback:ne=>{console.log("Renewal successful:",ne)},closeCallback:()=>{console.log("Checkout closed")}}):y("Failed to initiate renewal. Please try again.")}catch(f){console.error("Renewal failed:",f);const M=((m=(r=f==null?void 0:f.response)==null?void 0:r.data)==null?void 0:m.error)||((S=(N=f==null?void 0:f.response)==null?void 0:N.data)==null?void 0:S.message)||"Renewal failed. Please try again.";y(M)}finally{I(!1),k(!1)}}},o=()=>{y(null),k(!0)},w=()=>{k(!1)};i.useEffect(()=>{(async()=>{var m,N;try{const S=localStorage.getItem("authToken"),f=await U.get(`${F}organizations/user-subscription/admin-organization`,{headers:{Authorization:S}});x(f.data),console.log("API Response:",f.data)}catch(S){console.error("Failed to fetch subscription:",S),y(((N=(m=S==null?void 0:S.response)==null?void 0:m.data)==null?void 0:N.message)||"Error fetching subscription")}finally{v(!1)}})()},[]);const O=r=>{if(!r)return 0;const m=new Date,S=new Date(r)-m;return Math.ceil(S/(1e3*60*60*24))},c=r=>{switch(r==null?void 0:r.toLowerCase()){case"basic":return"from-gray-500 to-gray-700";case"pro":return"from-blue-500 to-blue-700";case"enterprise":return"from-purple-500 to-purple-700";default:return"from-blue-500 to-blue-700"}},L=()=>{var m,N;const r=((N=(m=a==null?void 0:a.planDetails)==null?void 0:m.features)==null?void 0:N.maxOrganizations)||0;return r>0?p/r*100:0},T=r=>(r==null?void 0:r.charAt(0).toUpperCase())+(r==null?void 0:r.slice(1))||"Basic",R=()=>{var r,m;return((m=(r=a==null?void 0:a.planDetails)==null?void 0:r.pricing)==null?void 0:m["1"])||0},B=()=>{var N;const r=[],m=((N=a==null?void 0:a.planDetails)==null?void 0:N.features)||{};return m.maxOrganizations&&r.push(`Up to ${m.maxOrganizations} organizations`),m.allowCustomBranding&&r.push("Custom branding"),m.advancedAnalytics&&r.push("Advanced analytics"),m.prioritySupport&&r.push("Priority support"),r.push("Basic admin tools"),r};if(C)return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 md:p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"})]})});if(g||!a)return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:[e.jsx(D,{className:"h-12 w-12 text-red-400 mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"Subscription Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:g||"Failed to load subscription data"}),e.jsx(ie,{to:"/admin-organization",children:e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Get Started"})})]})});const h=O(a==null?void 0:a.nextBillingDate),K=L(),G=((q=(J=a==null?void 0:a.planDetails)==null?void 0:J.features)==null?void 0:q.maxOrganizations)||0,H=a.isActive&&a.status==="active";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 md:w-12 md:h-12 bg-gradient-to-br ${c(a.package)} rounded-lg flex items-center justify-center flex-shrink-0`,children:e.jsx(Ne,{className:"h-5 w-5 md:h-6 md:w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg md:text-xl font-semibold text-gray-900",children:[T(a.package)," Plan"]}),e.jsxs("p",{className:"text-gray-600",children:["$",R(),"/month"]})]})]}),e.jsxs("div",{className:"text-left md:text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Current Status"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs md:text-sm font-medium ${H?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:H?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Organizations"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[p," of ",G]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${K>=80?"bg-red-500":K>=60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(K,100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500",children:[Math.max(G-p,0)," ","organizations remaining"]})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Next Billing"})]}),e.jsx("span",{className:"text-sm text-gray-600",children:a.nextBillingDate?new Date(a.nextBillingDate).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-base md:text-lg font-semibold ${h<=7?"text-red-600":h<=30?"text-yellow-600":"text-green-600"}`,children:h>0?`${h} days remaining`:"Expired"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Auto-renewal enabled"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{className:"flex items-center justify-between w-full md:hidden p-3 bg-gray-50 rounded-lg",onClick:()=>d(!j),children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Plan Features"}),j?e.jsx(ae,{className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4"})]}),e.jsx("h4",{className:"hidden md:block text-sm font-medium text-gray-700 mb-2",children:"Plan Features"}),e.jsxs("div",{className:`${j?"block":"hidden"} md:block`,children:[e.jsx("div",{className:"flex flex-wrap gap-2 mt-2 md:mt-0",children:B().map((r,m)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-50 text-blue-700",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),r]},m))}),((X=a.planDetails)==null?void 0:X.description)&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:a.planDetails.description})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:P?e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 rounded-lg border border-blue-200 w-full",children:[e.jsx("span",{className:"text-sm text-blue-800 flex-1",children:"Confirm renewal?"}),e.jsx("button",{onClick:s,disabled:u,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 disabled:opacity-50",children:u?"Processing...":"Yes"}),e.jsx("button",{onClick:w,disabled:u,className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded hover:bg-gray-400",children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:o,disabled:u||!(a!=null&&a.moduleKey),className:"flex items-center text-xs justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex-1 sm:flex-none disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{children:"Renew Plan"})]}),e.jsxs("button",{onClick:n,className:"flex items-center text-xs justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex-1 sm:flex-none",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"Change Plan"})]})]})}),h<=30&&!P&&e.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx(D,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-sm text-yellow-800 flex-1",children:[e.jsx("strong",{children:"Expiring Soon:"})," Your subscription"," ",h>0?`expires in ${h} day${h!==1?"s":""}.`:"has expired."," ","Renew now to avoid service interruption."]})]}),e.jsx("button",{onClick:o,disabled:u,className:"w-full sm:w-auto px-3 py-1 bg-yellow-600 text-white text-xs rounded hover:bg-yellow-700 transition-colors disabled:opacity-50",children:u?"Processing...":"Renew Now"})]}),g&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800",children:g})})]}),e.jsx(Se,{isOpen:$,onClose:()=>A(!1),currentPlan:a==null?void 0:a.package,moduleKey:a==null?void 0:a.moduleKey,onUpgradeSuccess:l})]})},Ge=()=>{const[b,a]=i.useState(null),[x,C]=i.useState("all"),[v,g]=i.useState([]),[y,p]=i.useState(!0),[z,j]=i.useState(null),[d,u]=i.useState(!1),[I,P]=i.useState(window.innerWidth<768),k=Y();i.useEffect(()=>{const s=()=>{P(window.innerWidth<768)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),i.useEffect(()=>{(async()=>{try{p(!0);const o=localStorage.getItem("authToken"),O=(await U.get(`${F}org/owned`,{headers:{Authorization:o}})).data.map(c=>{var L,T,R,B;return{id:c._id,name:c.name,type:"Organization",members:0,status:((L=c.subscription)==null?void 0:L.status)==="active"?"active":"inactive",subscriptionEnd:c.trialEndsAt?new Date(c.trialEndsAt).toISOString().split("T")[0]:"N/A",subscriptionPlan:((T=c.subscription)==null?void 0:T.plan)||"free",description:c.description,website:c.website,isPublic:c.isPublic,joinCode:c.joinCode,logoUrl:c.logoUrl,modules:((R=c.subscribedModules)==null?void 0:R.map(h=>({name:h.name||"Unknown Module",status:h.status||"active",expires:h.expiresAt?new Date(h.expiresAt).toISOString().split("T")[0]:c.trialEndsAt?new Date(c.trialEndsAt).toISOString().split("T")[0]:"N/A"})))||[{name:"Admin & Organization",status:((B=c.subscription)==null?void 0:B.status)==="active"?"active":"trial",expires:c.trialEndsAt?new Date(c.trialEndsAt).toISOString().split("T")[0]:"N/A"}]}});g(O),j(null)}catch(o){console.error("Error fetching organizations:",o),j("Failed to fetch organizations")}finally{p(!1)}})()},[]);const $={"Admin & Organization":V,"Event & Scheduling":ee,"Education & Upskilling":fe,"Marketing & Communication":oe,"Finance & Payment":je,"Member Engagement":Q,"Data & Analytics":re},A=s=>{switch(s){case"active":return"text-green-700 bg-green-100 border-green-200";case"trial":return"text-blue-700 bg-blue-100 border-blue-200";case"expiring":return"text-amber-700 bg-amber-100 border-amber-200";case"expired":case"inactive":return"text-red-700 bg-red-100 border-red-200";default:return"text-gray-700 bg-gray-100 border-gray-200"}},E=s=>{switch(s){case"active":return we;case"trial":return _;case"expiring":return _;case"expired":case"inactive":return D;default:return _}},t=s=>{if(!s||s==="N/A")return 0;const o=new Date,O=new Date(s)-o;return Math.ceil(O/(1e3*60*60*24))},n=v.filter(s=>x==="all"?!0:x==="expiring"?s.modules.some(o=>{const w=t(o.expires);return w>0&&w<=30}):s.modules.some(o=>o.status===x)),l=()=>{window.location.reload()};return y?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading your organizations..."})]})}):z?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx(D,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-4",children:z}),e.jsxs("button",{onClick:l,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"min-h-screen bg-white text-xs",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{children:e.jsx(ze,{orgCount:v.length})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Organizations"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage all your organizations in one place"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{className:"sm:hidden flex items-center justify-between w-full px-4 py-2 bg-white border border-gray-300 rounded-lg",onClick:()=>u(!d),children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Filter Organizations"]}),d?e.jsx(ae,{className:"h-4 w-4"}):e.jsx(W,{className:"h-4 w-4"})]}),e.jsx("div",{className:`${d?"block":"hidden"} sm:block`,children:e.jsxs("select",{className:"w-full sm:w-auto px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:x,onChange:s=>C(s.target.value),children:[e.jsx("option",{value:"all",children:"All Organizations"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"expiring",children:"Expiring Soon"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})}),e.jsxs("button",{className:"flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",onClick:()=>k("/organizations/create"),children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"New Organization"]})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx(Q,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No organizations found"}),e.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:x==="all"?"You don't have any organizations yet. Create your first organization to get started.":`No organizations match the "${x}" filter. Try a different filter.`}),x!=="all"&&e.jsx("button",{className:"mt-4 px-4 py-2 text-blue-600 hover:text-blue-800",onClick:()=>C("all"),children:"Clear filters"})]}):n.map(s=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:s.logoUrl?e.jsx("img",{src:s.logoUrl,alt:s.name,className:"w-full h-full object-cover",onError:o=>{o.target.style.display="none",o.target.nextSibling.style.display="flex"}}):e.jsx("span",{className:"text-white font-bold text-lg",children:s.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-gray-600 text-sm",children:[s.subscriptionPlan.charAt(0).toUpperCase()+s.subscriptionPlan.slice(1)," ","Plan",s.joinCode&&` • Join Code: ${s.joinCode}`]}),s.description&&e.jsx("p",{className:"text-gray-500 text-sm mt-1 line-clamp-1",children:s.description})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>k(`/dashboard/membership/${s.id}/view`),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm whitespace-nowrap",children:"Dashboard"}),e.jsx("button",{onClick:()=>a(b===s.id?null:s.id),className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm whitespace-nowrap",children:b===s.id?"Hide":"Details"})]})})]}),e.jsx("div",{className:"flex overflow-x-auto gap-2 mb-4 pb-2 -mx-1 px-1 scrollbar-hide",children:s.modules.map((o,w)=>{const O=$[o.name]||V,c=E(o.status);return e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-50 rounded-full border border-gray-200 whitespace-nowrap flex-shrink-0",children:[e.jsx(O,{className:"h-3.5 w-3.5 text-gray-600"}),e.jsx("span",{className:"text-xs text-gray-700",children:o.name}),e.jsx(c,{className:`h-3 w-3 ${A(o.status).split(" ")[0]}`})]},w)})}),b===s.id&&e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"mt-6 pt-4 border-t",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Organization Details"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[s.website&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 text-gray-500"}),e.jsxs("a",{href:s.website.startsWith("http")?s.website:`https://${s.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:[s.website.replace(/^https?:\/\//,""),e.jsx(be,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.isPublic?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:"Public Organization"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-700",children:"Private Organization"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-700",children:"Join Code:"}),e.jsx("span",{className:"font-mono text-gray-800 bg-gray-100 px-2 py-1 rounded text-xs",children:s.joinCode})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-700",children:"Plan:"}),e.jsx("span",{className:"text-gray-800 capitalize",children:s.subscriptionPlan})]})]})]})})]})},s.id))})})]})};export{Ge as default};
