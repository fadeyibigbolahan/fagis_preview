import{m as Q,r,j as e,P as W,S as q,M as $,C as X,v as F,i as j,k as f}from"./index-CS7ZgHMT.js";import{T as _,a as K,b as y,c,d as Y,e as n,S as Z}from"./table-DSMIUmFW.js";import{B as o}from"./button-CnXvB2RQ.js";import{S as ee,F as se}from"./Failure-C4Dg2hMN.js";import{D as ae,c as te,d as le,e as w}from"./dropdown-menu-CkwzdiRk.js";import{D as re}from"./download-DLEFp4kK.js";import{U as A}from"./user-D8vhwrcc.js";import{S as ne}from"./search-CokmW1tD.js";import{F as ie}from"./filter-BBmD6SGh.js";import{E as ce}from"./ellipsis-vertical-HnfmiEW9.js";import{S as oe}from"./square-pen-DkRzR1nR.js";import{T as de}from"./trash-2-CnH9xELA.js";import{X as me}from"./x-Dwv1eVjA.js";import{C as xe}from"./circle-dollar-sign-BaYRGgEb.js";import"./check-Duj1-6fA.js";import"./index-Dc-6mS6d.js";import"./chevron-right-DWZf5eQ0.js";const Te=()=>{const{orgId:d}=Q(),[x,E]=r.useState(""),[u,L]=r.useState("all"),[a,p]=r.useState(null),[P,S]=r.useState(!1),[i,C]=r.useState([]),[ue,B]=r.useState(null),[M,h]=r.useState(""),[R,b]=r.useState(!1),[O,N]=r.useState(!1),[k,D]=r.useState(!1),[g,U]=r.useState(0);r.useEffect(()=>{(async()=>{try{const t=localStorage.getItem("authToken"),{data:l}=await j.get(`${f}organizations/${d}/members`,{headers:{Authorization:t}});console.log("members",l),C(l.members)}catch(t){console.error(t),B("Failed to fetch organization data")}})()},[d]);const v=(s,t)=>{p(l=>({...l,[s]:t}))},V=async()=>{var s,t;D(!0);try{const l=localStorage.getItem("authToken"),{data:m}=await j.patch(`${f}organizations/${d}/members/${a.userId}`,{role:a.role,membershipLevel:a.membershipLevel,status:a.status,credit:g},{headers:{Authorization:l}});h("Changes saved successfully!"),b(!0)}catch(l){h(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to update member"),N(!0)}finally{D(!1)}},z=r.useMemo(()=>i.filter(s=>{const t=s.fullName.toLowerCase().includes(x.toLowerCase())||s.email.toLowerCase().includes(x.toLowerCase()),l=u==="all"||s.status===u;return t&&l}),[i,x,u]),I=s=>{p(s),S(!0)},T=()=>{S(!1),p(null)},G=async s=>{var t,l;try{const m=localStorage.getItem("authToken");await j.delete(`${f}organizations/${d}/members/${s.userId}`,{headers:{Authorization:m}}),h("Member removed successfully!"),b(!0);const{data:J}=await j.get(`${f}organizations/${d}/members`,{headers:{Authorization:m}});C(J.members)}catch(m){h(((l=(t=m.response)==null?void 0:t.data)==null?void 0:l.message)||"Failed to remove member"),N(!0)}},H=s=>{switch(s){case"approved":return"bg-green-100 text-green-700 border border-green-200";case"pending":return"bg-yellow-100 text-yellow-700 border border-yellow-200";case"inactive":return"bg-gray-100 text-gray-700 border border-gray-200";default:return"bg-gray-100 text-gray-700 border border-gray-200"}};return e.jsxs("div",{className:"min-h-screen bg-white md:p-6 p-2",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Member Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your organization's members"})]}),e.jsxs("div",{className:"flex gap-3 mt-4 sm:mt-0",children:[e.jsxs(o,{className:"flex items-center gap-2 bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(re,{size:16}),"Export"]}),e.jsxs(o,{className:"flex items-center gap-2 bg-blue-600 text-white hover:bg-blue-700",children:[e.jsx(W,{size:16}),"Add Member"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Members"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length})]}),e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(A,{className:"w-5 h-5 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.filter(s=>s.status==="approved").length})]}),e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.filter(s=>s.status==="pending").length})]}),e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx($,{className:"w-5 h-5 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Inactive"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.filter(s=>s.status==="inactive").length})]}),e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(X,{className:"w-5 h-5 text-gray-600"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2 sm:mb-0",children:"All Members"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search members...",value:x,onChange:s=>E(s.target.value),className:"pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsxs("select",{value:u,onChange:s=>L(s.target.value),className:"pl-10 pr-8 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full appearance-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto text-xs",children:e.jsx("div",{className:"max-h-[500px] overflow-y-auto text-xs relative",children:e.jsxs(_,{children:[e.jsx(K,{children:e.jsxs(y,{className:"border-b border-gray-200",children:[e.jsx(c,{className:"font-medium text-gray-700",children:"Member"}),e.jsx(c,{className:"font-medium text-gray-700",children:"Email"}),e.jsx(c,{className:"font-medium text-gray-700",children:"Role"}),e.jsx(c,{className:"font-medium text-gray-700",children:"Joined"}),e.jsx(c,{className:"font-medium text-gray-700",children:"Status"}),e.jsx(c,{className:"font-medium text-gray-700 text-right",children:"Actions"})]})}),e.jsx(Y,{children:z.length>0?z.map(s=>e.jsxs(y,{className:"border-b border-gray-100 hover:bg-gray-50 text-xs",children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.avatarUrl||F,alt:s.fullName,className:"w-10 h-10 rounded-full object-cover"}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-gray-900",children:s.fullName})})]})}),e.jsx(n,{className:"text-xs text-gray-600",children:s.email}),e.jsx(n,{children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full capitalize",children:s.role})}),e.jsx(n,{className:"text-sm text-gray-600",children:new Date(s.joinDate).toLocaleDateString()}),e.jsx(n,{children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${H(s.status)}`,children:s.status})}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{onClick:()=>I(s),className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-lg hover:bg-blue-700 transition",children:"View"}),e.jsxs(ae,{children:[e.jsx(te,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"icon",children:e.jsx(ce,{className:"w-4 h-4"})})}),e.jsxs(le,{align:"end",className:"w-48",children:[e.jsxs(w,{onClick:()=>I(s),className:"flex items-center",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Edit Member"]}),e.jsxs(w,{onClick:()=>window.location.href=`mailto:${s.email}`,className:"flex items-center",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Send External Email"]}),e.jsxs(w,{onClick:()=>window.confirm(`Are you sure you want to remove ${s.fullName} from the organization?`)&&G(s),className:"flex items-center text-red-600",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]})]})})]},s._id)):e.jsx(y,{children:e.jsx(n,{colSpan:6,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[e.jsx(A,{className:"w-12 h-12 mb-2 opacity-50"}),e.jsx("p",{className:"font-medium",children:"No members found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filter"})]})})})})]})})})]}),P&&a&&e.jsxs("div",{className:"w-full md:w-1/3 absolute p-3 right-0 bottom-0 h-[90%] bg-white/70 backdrop-blur-md shadow-lg border-l border-white/40 flex justify-start items-center flex-col",children:[e.jsx("div",{className:"flex justify-start w-full p-2",children:e.jsx("div",{onClick:T,className:"bg-black/50 rounded-full p-1 flex justify-center items-center cursor-pointer",children:e.jsx(me,{className:"w-4 h-4 text-white"})})}),e.jsx("div",{className:"h-[90%] overflow-y-auto w-full",children:e.jsxs("div",{className:"w-full flex flex-col justify-center items-center mt-4 gap-2",children:[e.jsx("div",{className:"w-[100px] h-[100px] bg-red-200 rounded-full overflow-hidden",children:e.jsx("img",{src:a.avatarUrl||F,className:"w-full h-full object-cover",alt:a.fullName})}),e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Name:"}),e.jsx("p",{className:"text-sm font-medium",children:a.fullName})]}),e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Email:"}),e.jsx("p",{className:"text-sm font-medium",children:a.email})]}),e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Phone Number:"}),e.jsx("p",{className:"text-sm font-medium",children:a==null?void 0:a.phone})]}),e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Joined Date:"}),e.jsx("p",{className:"text-sm font-medium",children:new Date(a.joinDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Member ID:"}),e.jsx("p",{className:"text-sm font-medium",children:a.membershipId})]}),e.jsxs("div",{className:"flex gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Wallet Balance:"}),e.jsxs("p",{className:"text-sm font-medium",children:["$",a==null?void 0:a.walletBalance," ",g>0&&`+ ${g}`]})]}),e.jsxs("div",{className:"flex justify-center items-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex flex-col gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Membership Level:"}),e.jsxs("select",{value:a.membershipLevel,onChange:s=>v("membershipLevel",s.target.value),className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-xs",children:[e.jsx("option",{value:"Basic",children:"Basic"}),e.jsx("option",{value:"Silver",children:"Silver"}),e.jsx("option",{value:"Gold",children:"Gold"}),e.jsx("option",{value:"VIP",children:"VIP"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Membership Role:"}),e.jsxs("select",{value:a.role,onChange:s=>v("role",s.target.value),className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-xs",children:[e.jsx("option",{value:"owner",children:"Owner"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"member",children:"Member"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 justify-center items-center",children:[e.jsx("p",{className:"text-xs",children:"Status:"}),e.jsxs("select",{value:a.status,onChange:s=>v("status",s.target.value),className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-xs",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center gap-2 w-2/3",children:[e.jsx("p",{className:"text-xs",children:"Fund Wallet:"}),e.jsxs("div",{className:"flex flex-row justify-center items-center gap-2 border rounded-md w-full p-1",children:[e.jsx(xe,{}),e.jsx("input",{value:g,onChange:s=>U(s.target.value),placeholder:"Enter amount",type:"number",className:"w-auto outline-none"})]}),e.jsx("p",{className:"text-[10px] text-center",children:"The specified amount will be debited from the organization's wallet and added to this user's wallet."})]}),e.jsxs("div",{className:"flex justify-center items-center gap-3 mt-6",children:[e.jsx(o,{onClick:()=>V(),disabled:k,className:"bg-black text-white text-xs px-4 py-2 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4"}),"Save Changes"]})}),e.jsx(o,{variant:"outline",onClick:T,className:"text-xs px-4 py-2 border border-gray-300",children:"Cancel"})]})]})})]})]}),R&&e.jsx(ee,{message:M,onClose:()=>b(!1)}),O&&e.jsx(se,{message:M,onClose:()=>N(!1)})]})};export{Te as default};
