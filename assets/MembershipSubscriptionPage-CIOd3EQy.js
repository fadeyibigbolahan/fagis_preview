import{r as m,u as E,i as z,k as B,j as e,a as y,U as T,W as F,C as U}from"./index-CS7ZgHMT.js";import{A as L}from"./arrow-left-B3FDB5CS.js";import{R as N}from"./rotate-ccw-Brr5KhU0.js";import{C as p}from"./circle-x-BOXI9SGK.js";import{C as g}from"./circle-alert-BRc3jNk4.js";import{C as $}from"./circle-check-big-CUbDje_B.js";import{D as W}from"./dollar-sign-DxUMZJa9.js";import{C as Y}from"./clock-knIbMwKl.js";import{C as _}from"./chevron-right-DWZf5eQ0.js";const Z=()=>{var k;const[f,S]=m.useState([]),[a,x]=m.useState(null),[h,w]=m.useState(!1),[l,i]=m.useState({type:"",text:""}),[r,d]=m.useState(""),I=E();m.useEffect(()=>{v()},[]);const v=async()=>{try{const s=localStorage.getItem("authToken"),t=await z.get(`${B}organizations/subscriptions`,{headers:{Authorization:s}});console.log("subscriptions",t.data),S(t.data)}catch(s){console.error("Failed to load memberships",s),i({type:"error",text:"Failed to load memberships"})}},C=async s=>{var t,b;if(!a){i({type:"error",text:"Please select a membership"});return}w(!0),i({type:"",text:""});try{const c=localStorage.getItem("authToken");let o="";switch(s){case"subscribe":o="subscribe";break;case"renew":o="renew";break;case"cancel":o="cancel";break;default:throw new Error("Invalid action type")}const u=await z.post(`${B}payments/${a._id}/${o}`,{},{headers:{Authorization:c}});console.log("responsee",u),i({type:"success",text:u.data.message||`${s.charAt(0).toUpperCase()+s.slice(1)} successful!`}),v(),s!=="cancel"&&(x(null),d(""))}catch(c){console.error(`${s} error:`,c),i({type:"error",text:((b=(t=c.response)==null?void 0:t.data)==null?void 0:b.message)||`Failed to ${s} membership`})}finally{w(!1)}},M=()=>{d("cancel"),i({type:"warning",text:"Are you sure you want to cancel your subscription? Your access will be limited after the current billing period."})},j=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",A=s=>{const t={active:"bg-emerald-100 text-emerald-800 border border-emerald-200",pending:"bg-amber-100 text-amber-800 border border-amber-200",inactive:"bg-gray-100 text-gray-800 border border-gray-200",canceled:"bg-red-100 text-red-800 border border-red-200",expired:"bg-gray-100 text-gray-800 border border-gray-200"};return e.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium uppercase tracking-wide ${t[s]||"bg-gray-100 text-gray-800"}`,children:s})},n=({children:s,onClick:t,variant:b="primary",disabled:c=!1,className:o="",size:u="md"})=>{const D="inline-flex items-center justify-center font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-lg",R={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3 text-base"},P={primary:"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-500 border border-gray-900",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500",success:"bg-emerald-600 text-white hover:bg-emerald-700 focus:ring-emerald-500 border border-emerald-600",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 border border-red-600",outline:"bg-transparent text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500",ghost:"bg-transparent text-gray-600 hover:bg-gray-100 focus:ring-gray-500"};return e.jsx("button",{onClick:t,disabled:c,className:`${D} ${R[u]} ${P[b]} ${c?"opacity-50 cursor-not-allowed":""} ${o}`,children:s})};return r&&a?e.jsx("div",{className:"min-h-screen bg-white py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs(n,{variant:"ghost",onClick:()=>{d(""),x(null),i({type:"",text:""})},className:"mb-6 !px-2 !py-1.5 text-sm text-gray-600",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Back to memberships"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:`px-6 py-6 text-white ${r==="cancel"?"bg-red-600":"bg-gray-900"}`,children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"bg-white/10 p-3 rounded-lg",children:r==="subscribe"?e.jsx(y,{className:"h-6 w-6"}):r==="renew"?e.jsx(N,{className:"h-6 w-6"}):e.jsx(p,{className:"h-6 w-6"})})}),e.jsxs("h2",{className:"text-xl font-semibold text-center mb-2",children:[r==="subscribe"&&"Subscribe to Membership",r==="renew"&&"Renew Membership",r==="cancel"&&"Cancel Subscription"]}),e.jsxs("p",{className:"text-gray-300 text-center text-sm max-w-md mx-auto",children:[r==="subscribe"&&"Join the organization and access exclusive features",r==="renew"&&"Continue your membership and maintain full access",r==="cancel"&&"Cancel your subscription and limit access to basic features"]})]}),e.jsxs("div",{className:"p-6",children:[l.text&&e.jsx("div",{className:`p-4 rounded-lg mb-6 border ${l.type==="error"?"bg-red-50 text-red-800 border-red-200":l.type==="warning"?"bg-amber-50 text-amber-800 border-amber-200":"bg-emerald-50 text-emerald-800 border-emerald-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[l.type==="error"?e.jsx(g,{className:"h-4 w-4 mr-3 flex-shrink-0"}):l.type==="warning"?e.jsx(g,{className:"h-4 w-4 mr-3 flex-shrink-0"}):e.jsx($,{className:"h-4 w-4 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:l.text})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(T,{className:"h-5 w-5 mr-2 text-gray-600"}),(k=a.organizationId)==null?void 0:k.name]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-4 w-4 text-gray-600 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Membership Fee"})]}),e.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:["$",a.organizationId.membershipFee]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"h-4 w-4 text-gray-600 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Wallet Balance"})]}),e.jsxs("span",{className:`text-lg font-semibold ${a.walletBalance>=a.organizationId.membershipFee?"text-emerald-600":"text-red-600"}`,children:["$",a.walletBalance]})]})}),a.nextBillingDate&&e.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-4 w-4 text-gray-600 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Next Billing Date"})]}),e.jsx("span",{className:"font-medium text-gray-900",children:j(a.nextBillingDate)})]})})]})]}),r!=="cancel"&&a.walletBalance<a.organizationId.membershipFee&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(g,{className:"h-4 w-4 text-red-500 mr-3 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800 text-sm",children:"Insufficient Balance"}),e.jsxs("p",{className:"text-red-700 text-xs mt-1",children:["Your wallet balance is insufficient. Please add $",a.organizationId.membershipFee-a.walletBalance," ","more to proceed."]})]})]})}),e.jsx("div",{className:"space-y-3",children:r==="cancel"&&l.type==="warning"?e.jsxs(e.Fragment,{children:[e.jsx(n,{onClick:()=>C("cancel"),disabled:h,className:"w-full",variant:"danger",size:"lg",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Confirm Cancellation"]})}),e.jsx(n,{onClick:()=>{i({type:"",text:""}),d("")},className:"w-full",variant:"outline",size:"lg",children:"Go Back"})]}):e.jsx(n,{onClick:()=>C(r),disabled:h||r!=="cancel"&&a.walletBalance<a.organizationId.membershipFee,className:"w-full",variant:r==="cancel"?"danger":a.walletBalance>=a.organizationId.membershipFee?"success":"primary",size:"lg",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):r==="subscribe"?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Subscribe Now - $",a.organizationId.membershipFee]}):r==="renew"?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Renew Membership - $",a.organizationId.membershipFee]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Cancel Subscription"]})})})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-white py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-gray-900 mb-2",children:"Membership Management"}),e.jsx("p",{className:"text-gray-600 text-sm max-w-2xl mx-auto",children:"Manage your organization memberships and subscriptions"})]}),l.text&&e.jsx("div",{className:`p-4 rounded-lg mb-6 border max-w-4xl mx-auto ${l.type==="error"?"bg-red-50 text-red-800 border-red-200":"bg-emerald-50 text-emerald-800 border-emerald-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[l.type==="error"?e.jsx(g,{className:"h-4 w-4 mr-3 flex-shrink-0"}):e.jsx($,{className:"h-4 w-4 mr-3 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:l.text})]})}),e.jsx("div",{className:"space-y-4",children:f.length===0?e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden max-w-2xl mx-auto",children:e.jsxs("div",{className:"text-center py-12 px-8",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-4 w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(F,{className:"h-8 w-8 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Subscription found"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"No pending subscription from any organization"})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:f.map(s=>{var t;return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:(t=s.organizationId)==null?void 0:t.name}),e.jsxs("div",{className:"flex items-center text-gray-500 text-xs",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),"Member since ",j(s.createdAt)]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[A(s.subscriptionStatus),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:s.role})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium uppercase tracking-wide mb-1",children:"Fee"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["$",s.organizationId.membershipFee]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium uppercase tracking-wide mb-1",children:"Balance"}),e.jsxs("p",{className:`text-lg font-semibold ${s.walletBalance>=s.organizationId.membershipFee?"text-emerald-600":"text-red-600"}`,children:["$",s.walletBalance]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium uppercase tracking-wide mb-1",children:"Next Bill"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.nextBillingDate?j(s.nextBillingDate):"N/A"})]})]}),s.walletBalance<s.organizationId.membershipFee&&s.subscriptionStatus==="active"&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(g,{className:"h-4 w-4 text-red-500 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-red-800",children:"Insufficient Balance"}),e.jsxs("p",{className:"text-xs text-red-700 mt-1",children:["Add $",s.organizationId.membershipFee-s.walletBalance," ","more to renew."]})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[s.subscriptionStatus!=="active"?e.jsxs(n,{onClick:()=>{x(s),d("subscribe")},disabled:s.walletBalance<s.organizationId.membershipFee,className:"flex-1",variant:"success",size:"sm",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Subscribe"]}):e.jsxs(e.Fragment,{children:[e.jsxs(n,{variant:"outline",onClick:()=>{x(s),d("renew")},disabled:s.walletBalance<s.organizationId.membershipFee,className:"flex-1",size:"sm",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"Renew"]}),e.jsxs(n,{variant:"ghost",onClick:()=>{x(s),M()},className:"flex-1",size:"sm",children:[e.jsx(p,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),e.jsx(n,{variant:"ghost",onClick:()=>I("/dashboard/transactions"),className:"flex-initial",size:"sm",children:e.jsx(_,{className:"h-3 w-3"})})]})]})]},s._id)})})})]})})};export{Z as default};
