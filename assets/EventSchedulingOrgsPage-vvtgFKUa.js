import{c as G,r as i,j as e,C as E,i as B,k as O,D as V,b as W,S as q,U as L}from"./index-C3Nn7RB1.js";import{C as R}from"./calendar-days-BtShpG3n.js";import{R as H,T as J}from"./trending-down-DfGkhIhX.js";import{T as K}from"./trending-up-BvfJuqPt.js";import{T as Q}from"./ticket-Kn2mLOcB.js";import{R as X}from"./repeat-BHGAHeIl.js";import{A as Z}from"./award-BjXw75Rb.js";import{V as ee}from"./video-B5O9m45s.js";import{C as z}from"./clock-D9Ud996j.js";import{M as I}from"./map-pin-BFSeZid8.js";import{S as se,T as te}from"./trash-2-Dvk5OlcT.js";import{S as $}from"./share-2-CModg5mI.js";import{E as re}from"./eye-B965LG77.js";import{S as ae}from"./square-pen-Chz6NWUP.js";/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=G("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),le=({eventsThisMonth:m=0})=>{var y,P,M;const[a,C]=i.useState(null),[v,g]=i.useState(!0),[N,p]=i.useState(null),[f,j]=i.useState(m);if(i.useEffect(()=>{j(m)},[m]),i.useEffect(()=>{(async()=>{var l,d;try{const x=localStorage.getItem("authToken"),S=await B.get(`${O}organizations/user-subscription/event-scheduling`,{headers:{Authorization:x}});console.log("Subscription data:",S.data),C(S.data),g(!1)}catch(x){console.error("Failed to fetch subscription:",x),p(((d=(l=x==null?void 0:x.response)==null?void 0:l.data)==null?void 0:d.message)||"Error fetching subscription"),g(!1)}})()},[]),v)return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"})]})});if(N||!a)return e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:e.jsx("div",{className:"text-center text-red-600",children:N||"Failed to load subscription data"})});const A=r=>{const l=new Date,x=new Date(r)-l;return Math.ceil(x/(1e3*60*60*24))},w=r=>{switch(r==null?void 0:r.toLowerCase()){case"free":return"from-gray-500 to-gray-700";case"basic":return"from-blue-500 to-blue-700";case"pro":return"from-purple-500 to-purple-700";case"enterprise":return"from-indigo-500 to-indigo-700";default:return"from-blue-500 to-blue-700"}},D=()=>{var l,d;const r=(d=(l=a==null?void 0:a.planDetails)==null?void 0:l.features)==null?void 0:d.maxEventsPerMonth;return r==="unlimited"?0:r>0?f/r*100:0},T=r=>(r==null?void 0:r.charAt(0).toUpperCase())+(r==null?void 0:r.slice(1))||"Basic",k=()=>{var r,l;return((l=(r=a==null?void 0:a.planDetails)==null?void 0:r.pricing)==null?void 0:l["1"])||0},F=()=>{var d;const r=[],l=((d=a==null?void 0:a.planDetails)==null?void 0:d.features)||{};if(l.maxEventsPerMonth){const x=l.maxEventsPerMonth==="unlimited"?"Unlimited":l.maxEventsPerMonth;r.push({icon:R,text:`${x} events per month`})}return l.ticketing&&r.push({icon:Q,text:"Event ticketing"}),l.reminders&&r.push({icon:V,text:"Email reminders"}),l.recurringEvents&&r.push({icon:X,text:"Recurring events"}),l.certificateSupport&&r.push({icon:Z,text:"Certificate generation"}),l.analytics&&r.push({icon:W,text:"Advanced analytics"}),l.eventAccessControl&&r.push({icon:q,text:"Event access control"}),l.webinarIntegration&&r.push({icon:ee,text:"Webinar integration"}),r},h=A(a==null?void 0:a.nextBillingDate),b=D(),u=(P=(y=a==null?void 0:a.planDetails)==null?void 0:y.features)==null?void 0:P.maxEventsPerMonth;return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${w(a.package)} rounded-lg flex items-center justify-center`,children:e.jsx(E,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[T(a.package)," Events Plan"]}),e.jsxs("p",{className:"text-gray-600",children:["$",k(),"/month"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Current Status"}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${a.isActive&&a.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.isActive&&a.status==="active"?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center space-x-2",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:"Events This Month"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[f," of"," ",u==="unlimited"?"âˆž":u]})]}),u!=="unlimited"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${b>=80?"bg-red-500":b>=60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(b,100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500",children:[u-f," events remaining this month"]})]}),u==="unlimited"&&e.jsx("p",{className:"text-xs text-gray-500",children:"Unlimited events available"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center space-x-2",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:"Next Billing"})]}),e.jsx("span",{className:"text-sm text-gray-600",children:new Date(a.nextBillingDate).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-lg font-semibold ${h<=30?"text-red-600":h<=60?"text-yellow-600":"text-green-600"}`,children:[h," days remaining"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Auto-renewal enabled"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Plan Features"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:F().map((r,l)=>{const d=r.icon;return e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-purple-50 border border-purple-100",children:[e.jsx(d,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm text-purple-800",children:r.text})]},l)})}),e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:(M=a.planDetails)==null?void 0:M.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:"Renew Plan"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:"Upgrade"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Downgrade"})]})]}),u!=="unlimited"&&b>=80&&e.jsx("div",{className:"mt-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-orange-800",children:[e.jsx("strong",{children:"High Usage:"})," You've used"," ",Math.round(b),"% of your monthly event limit. Consider upgrading if you need more events."]})}),h<=30&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Expiring Soon:"})," Your subscription expires in"," ",h," days. Renew now to avoid service interruption."]})})]})},ve=()=>{const[m,a]=i.useState([]),[C,v]=i.useState([]),[g,N]=i.useState(""),[p,f]=i.useState("all"),[j,A]=i.useState("all"),[w,D]=i.useState("date"),[T,k]=i.useState(!0),[F,h]=i.useState(!1),[b,u]=i.useState(null),[y,P]=i.useState([]),[M,r]=i.useState(0);i.useEffect(()=>{(async()=>{try{k(!0),u(null);const t=localStorage.getItem("authToken"),{data:n}=await B.get(`${O}events/owner/events`,{headers:{Authorization:t}});console.log("API Response:",n);const o=n.events.map(c=>({...c,organization:{_id:c.organizationId._id,name:c.organizationId.name,logoUrl:c.bannerUrl,brandColor:"#3B82F6"},bookings:c.members?c.members.length:0,capacity:c.members?Math.max(c.members.length*2,50):50,status:l(c.date,c.endDate)}));a(o),v(o),P(n.monthlyStats||[])}catch(t){console.error("Fetch events error:",t),u("Failed to load events. Please try again later."),a([]),v([])}finally{k(!1)}})()},[]),i.useEffect(()=>{if(y.length>0){const s=new Date,t=s.getFullYear(),n=s.getMonth()+1,o=y.find(c=>c._id.year===t&&c._id.month===n);r(o?o.totalEvents:0)}},[y]);const l=(s,t)=>{const n=new Date,o=new Date(s),c=new Date(t||s);return o>n?"upcoming":o<=n&&c>=n?"ongoing":"completed"};i.useEffect(()=>{let s=m;if(g&&(s=s.filter(t=>{var n;return t.title.toLowerCase().includes(g.toLowerCase())||t.description.toLowerCase().includes(g.toLowerCase())||t.location.toLowerCase().includes(g.toLowerCase())||((n=t.organization)==null?void 0:n.name.toLowerCase().includes(g.toLowerCase()))})),p!=="all"&&(s=s.filter(t=>t.type===p)),j!=="all"){const t=new Date;s=s.filter(n=>{const o=new Date(n.date),c=new Date(n.endDate||n.date);switch(j){case"upcoming":return o>t;case"ongoing":return o<=t&&c>=t;case"completed":return c<t;default:return!0}})}s.sort((t,n)=>{switch(w){case"date":return new Date(t.date)-new Date(n.date);case"title":return t.title.localeCompare(n.title);case"bookings":return n.bookings-t.bookings;case"capacity":return n.capacity-t.capacity;default:return 0}}),v(s)},[m,g,p,j,w]);const d=s=>{const t=new Date,n=new Date(s.date),o=new Date(s.endDate||s.date);return n>t?"upcoming":n<=t&&o>=t?"ongoing":"completed"},x=s=>{switch(s){case"upcoming":return"bg-blue-100 text-blue-800";case"ongoing":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},S=s=>{switch(s){case"workshop":return"bg-purple-100 text-purple-800";case"training":return"bg-orange-100 text-orange-800";case"course":return"bg-indigo-100 text-indigo-800";case"webinar":return"bg-teal-100 text-teal-800";case"general":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Y=s=>new Intl.DateTimeFormat("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(s)),U=s=>s===0?"Free":new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(s),_=()=>m.reduce((s,t)=>s+t.price*(t.bookings||0),0);return T?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-white text-xs p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(le,{eventsThisMonth:M}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-[#7A54A150] rounded-lg",children:e.jsx(E,{className:"h-6 w-6 text-[#7A54A1]"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Events"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-[#7A54A150] rounded-lg",children:e.jsx(L,{className:"h-6 w-6 text-[#7A54A1]"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Attendees"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.reduce((s,t)=>s+(t.bookings||0),0)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-[#7A54A150] rounded-lg",children:e.jsx(z,{className:"h-6 w-6 text-[#7A54A1]"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming Events"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.filter(s=>d(s)==="upcoming").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-[#7A54A150] rounded-lg",children:e.jsx(I,{className:"h-6 w-6 text-[#7A54A1]"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:U(_()).replace("NGN","â‚¦")})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search events, organizations...",value:g,onChange:s=>N(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:()=>h(!F),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"})]})})]}),F&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:p,onChange:s=>f(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"course",children:"Course"}),e.jsx("option",{value:"webinar",children:"Webinar"}),e.jsx("option",{value:"training",children:"Training"}),e.jsx("option",{value:"workshop",children:"Workshop"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:j,onChange:s=>A(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{value:w,onChange:s=>D(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"title",children:"Title"}),e.jsx("option",{value:"bookings",children:"Attendees"}),e.jsx("option",{value:"capacity",children:"Capacity"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{f("all"),A("all"),D("date"),N("")},className:"w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear Filters"})})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(s=>{var t,n,o;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative h-48",children:[e.jsx("img",{src:s.bannerUrl||"https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=400",alt:s.title,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute top-4 left-4 flex space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(d(s))}`,children:d(s)}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S(s.type)}`,children:s.type})]}),s.isRecurring&&e.jsx("div",{className:"absolute top-4 right-4 bg-white bg-opacity-90 rounded-full p-2",children:e.jsx(z,{className:"h-4 w-4 text-gray-600"})}),s.isPublic&&e.jsx("div",{className:"absolute bottom-4 right-4 bg-green-500 bg-opacity-90 text-white px-2 py-1 rounded text-xs",children:"Public"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:((n=(t=s.organization)==null?void 0:t.name)==null?void 0:n.charAt(0))||"O"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((o=s.organization)==null?void 0:o.name)||"Unknown Organization"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Event Organizer"})]})]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),Y(s.date)]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),s.location]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),s.bookings||0," attendees"]}),s.externalLink&&e.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"truncate",children:"External Link Available"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:U(s.price)}),s.certificateAvailable&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Certificate Available"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center justify-center space-x-1",children:[e.jsx(re,{className:"h-4 w-4"}),e.jsx("span",{children:"View"})]}),e.jsx("button",{className:"bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("button",{className:"bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:e.jsx($,{className:"h-4 w-4"})}),e.jsx("button",{className:"bg-red-50 text-red-600 py-2 px-4 rounded-lg hover:bg-red-100 transition-colors",children:e.jsx(te,{className:"h-4 w-4"})})]})]})]},s._id)})}),C.length===0&&!T&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No events found"}),e.jsx("p",{className:"text-gray-500",children:m.length===0?"You haven't created any events yet. Create your first event to get started!":"Try adjusting your search or filter criteria"})]})]})})};export{ve as default};
